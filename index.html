<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <meta name="description" content="Ù†Ø§ÙˆÙ„Ø³ØªØ§Ù†: Ø§Ø±Ø¯Ùˆ Ù†Ø§ÙˆÙ„Ø²ØŒ Ø¨ÛØªØ±ÛŒÙ† Ø´Ø§Ø¹Ø±ÛŒ Ø§ÙˆØ± Ù¾Ø±ÛŒÙ…ÛŒÙ… Ø§Ø¯Ø¨ÛŒ Ù…ÙˆØ§Ø¯ Ú©Ø§ Ù…Ø³ØªÙ†Ø¯ Ù…Ø±Ú©Ø²Û”">
    <title>Ù†Ø§ÙˆÙ„Ø³ØªØ§Ù† - Ù¾Ø±ÛŒÙ…ÛŒÙ… Ù¾ÙˆØ±Ù¹Ù„</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Nastaliq+Urdu:wght@400;700&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    
    <style>
        :root { 
            --bg: #0a0e27; 
            --card: #1a1f3a; 
            --accent: #ff0a54; 
            --accent2: #00d9ff; 
            --text: #ffffff;
            --success: #2ed573;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Noto Nastaliq Urdu', serif; 
            background: var(--bg); 
            color: var(--text);
            min-height: 100vh; 
            line-height: 1.6;
        }
        .container { max-width: 500px; margin: 0 auto; padding: 15px; }
        
        .header { 
            text-align: center; 
            border-bottom: 3px solid var(--accent); 
            border-radius: 0 0 30px 30px; 
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(255,10,84,0.2);
            overflow: hidden; 
            position: relative;
            background: var(--card);
        }
        .header-cover { width: 100%; height: 220px; object-fit: cover; display: block; }
        .header-content { 
            padding: 25px 10px; 
            background: linear-gradient(to bottom, transparent, rgba(10,14,39,0.9)); 
            margin-top: -70px; 
            position: relative; 
        }
        .header h1 { 
            font-size: 3rem; 
            text-shadow: 0 0 15px rgba(255,10,84,0.6); 
            cursor: pointer; 
        }

        .menu-grid { display: grid; gap: 15px; grid-template-columns: 1fr 1fr; }
        .nav-btn { 
            background: var(--card); 
            border-radius: 18px; 
            overflow: hidden; 
            border: 1px solid rgba(255,255,255,0.1); 
            transition: 0.2s;
            cursor: pointer;
        }
        .nav-btn:active { transform: scale(0.96); }
        .nav-btn img { width: 100%; height: 160px; object-fit: cover; }
        .nav-btn h3 { padding: 15px; text-align: center; font-size: 1.3rem; }

        .items-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .card { 
            background: #1a1f3a; 
            padding: 15px 10px; 
            border-radius: 12px; 
            text-align: center; 
            border: 1px solid #3a3f5a; 
            cursor: pointer; 
        }
        .card.locked { opacity: 0.7; border-style: dashed; border-color: var(--accent); }

        .modal { 
            display: none; 
            position: fixed; 
            inset: 0; 
            background: rgba(0,0,0,0.9); 
            justify-content: center; 
            align-items: center; 
            z-index: 1000; 
            padding: 20px; 
        }
        .modal.active { display: flex; }
        .modal-box { 
            background: #1a1f3a; 
            padding: 25px; 
            border-radius: 20px; 
            width: 100%; 
            max-width: 380px; 
            text-align: center; 
            border: 2px solid var(--accent); 
        }
        
        .wa-container { display: flex; gap: 8px; margin: 15px 0; }
        .btn-wa { 
            background: #16a34a; 
            color: #fff; 
            text-decoration: none; 
            padding: 12px; 
            border-radius: 10px; 
            flex: 1; 
            font-size: 0.9rem; 
            font-weight: bold; 
        }
        .btn-back { 
            background: var(--accent); 
            color: #fff; 
            border: none; 
            padding: 12px; 
            width: 100%; 
            border-radius: 10px; 
            margin-bottom: 15px; 
            cursor: pointer; 
            font-weight: bold; 
        }
        
        input { 
            width: 100%; 
            padding: 12px; 
            margin: 10px 0; 
            background: #000; 
            color: #fff; 
            border: 1px solid var(--accent2); 
            border-radius: 8px; 
            text-align: center; 
            font-size: 1.2rem; 
        }
        .btn-verify { 
            background: var(--accent2); 
            border: none; 
            width: 100%; 
            padding: 12px; 
            border-radius: 8px; 
            font-weight: bold; 
            cursor: pointer; 
            color: #000; 
        }
        .close-btn { 
            margin-top: 15px; 
            cursor: pointer; 
            display: inline-block; 
            color: var(--accent); 
            font-weight: bold; 
        }
        
        .novel-list-card { 
            background: var(--card); 
            padding: 25px; 
            border-radius: 15px; 
            border: 1px solid #3a3f5a; 
            margin-bottom: 15px; 
            text-align: center;
            cursor: pointer;
        }

        .puzzle-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        .puzzle-info-box {
            background: rgba(0,0,0,0.3);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }
        .timer-circle {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            border: 5px solid var(--accent);
            line-height: 90px;
            font-size: 32px;
            font-weight: bold;
            margin: 0 auto 20px;
            color: var(--accent);
            box-shadow: 0 0 20px rgba(255, 71, 87, 0.4);
        }
        .timer-circle.warning { border-color: #ff9800; color: #ff9800; }
        .q-text {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 25px;
            line-height: 1.6;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            border-right: 4px solid var(--accent);
        }
        .btn-opt {
            background: #2d2d3a;
            color: white;
            border: 2px solid #444;
            width: 100%;
            padding: 15px;
            margin: 8px 0;
            border-radius: 12px;
            font-size: 16px;
            cursor: pointer;
            transition: 0.3s;
        }
        .btn-opt:hover { background: var(--accent); border-color: var(--accent); }
        .tracking-display {
            background: #333;
            padding: 20px;
            border-radius: 12px;
            letter-spacing: 3px;
            color: var(--success);
            font-size: 28px;
            font-weight: bold;
            margin: 20px 0;
            border: 2px dashed var(--success);
            word-break: break-all;
        }
        
        footer { text-align: center; padding: 20px; opacity: 0.6; font-size: 0.8rem; }
    </style>
</head>
<body>
    <div id="home-screen" class="container">
        <header class="header">
            <img src="https://drive.google.com/thumbnail?id=18SlPABsEdm_mndblVL9xHUwCARh6ye7x&sz=w800" alt="Cover" class="header-cover" loading="eager">
            <div class="header-content">
                <h1 onclick="location.reload()">Ù†Ø§ÙˆÙ„Ø³ØªØ§Ù†</h1>
                <p>âœ¨ Ù¾Ø±ÛŒÙ…ÛŒÙ… Ø§Ø±Ø¯Ùˆ Ù¾ÙˆØ±Ù¹Ù„ âœ¨</p>
            </div>
        </header>
        <div class="menu-grid">
            <div class="nav-btn" onclick="openSection('novel')">
                <img src="https://drive.google.com/thumbnail?id=1A6cQPJd5qacANztlmKyU6a5xiKgNAUuz&sz=w400" alt="Novel" loading="lazy">
                <h3>ğŸ“– Ù†Ø§ÙˆÙ„ Ù¾Ú‘Ú¾ÛŒÚº</h3>
            </div>
            <div class="nav-btn" onclick="openSection('poetry')">
                <img src="https://drive.google.com/thumbnail?id=1jeO58Sf8-w5fx5SPQZG8LqJjm7QfPHTe&sz=w400" alt="Poetry" loading="lazy">
                <h3>ğŸ“œ Ø§Ø±Ø¯Ùˆ Ø´Ø§Ø¹Ø±ÛŒ</h3>
            </div>
            <div class="nav-btn" onclick="openSection('puzzle')">
                <img src="https://drive.google.com/thumbnail?id=11c5Imzwd7sOJ_yEL6gvgDQy85WW0Mvsi&sz=w400" alt="Puzzle Game" loading="lazy">
                <h3>ğŸ® Ù¾Ø²Ù„ Ú¯ÛŒÙ…</h3>
            </div>
            <div class="nav-btn" onclick="openSection('about')">
                <img src="https://drive.google.com/thumbnail?id=1bAfC0S2euvxZQKuawj_nVQGOiK9S41N7&sz=w400" alt="Author" loading="lazy">
                <h3>ğŸ‘¤ Ù…ØµÙ†Ù</h3>
            </div>
        </div>
    </div>

    <div id="novel-list-screen" class="container" style="display:none;">
        <button class="btn-back" onclick="location.reload()">ğŸ  ÛÙˆÙ… Ù¾ÛŒØ¬</button>
        <div id="novels-container"></div>
    </div>

    <div id="content-screen" class="container" style="display:none;">
        <button class="btn-back" onclick="goBack()">â¬…ï¸ ÙˆØ§Ù¾Ø³</button>
        <h2 id="section-title" style="text-align:center; margin-bottom:20px; color:var(--accent);"></h2>
        <div id="items-list" class="items-grid"></div>
    </div>

    <div id="puzzle-screen" class="container" style="display:none;">
        <button class="btn-back" onclick="location.reload()">ğŸ  ÛÙˆÙ… Ù¾ÛŒØ¬</button>
        
        <div id="puzzle-info" class="puzzle-section">
            <h2 style="font-size: 2rem; margin-bottom: 15px;">ğŸ® Ù¾Ø²Ù„ Ú¯ÛŒÙ… Ú†ÛŒÙ„Ù†Ø¬</h2>
            <div class="puzzle-info-box">
                <p style="font-size: 1.2rem; margin: 10px 0;">ğŸ’° ÙÛŒØ³: <strong>50 Ø±ÙˆÙ¾Û’</strong></p>
                <p style="font-size: 1.2rem; margin: 10px 0;">ğŸ† Ø§Ù†Ø¹Ø§Ù…: <strong>1000 Ø±ÙˆÙ¾Û’</strong></p>
                <p style="font-size: 1rem; margin: 10px 0; color: #ffd700;">â±ï¸ 5 Ø³ÙˆØ§Ù„Ø§Øª - ÛØ± Ø³ÙˆØ§Ù„ 60 Ø³ÛŒÚ©Ù†Úˆ</p>
                <p style="font-size: 1rem; margin: 10px 0; color: #ff6b6b;">âŒ ØºÙ„Ø· Ø¬ÙˆØ§Ø¨ = Ú¯ÛŒÙ… Ø®ØªÙ…</p>
            </div>
            
            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin: 20px 0;">
                <p style="font-size: 0.9rem; margin-bottom: 10px;">ğŸ’¡ Ú©ÛŒØ³Û’ Ú©Ú¾ÛŒÙ„ÛŒÚºØŸ</p>
                <p style="font-size: 0.85rem; line-height: 1.6;">
                    1ï¸âƒ£ ÙˆØ§Ù¹Ø³ Ø§ÛŒÙ¾ Ù¾Ø± Ø±Ø§Ø¨Ø·Û Ú©Ø±ÛŒÚº<br>
                    2ï¸âƒ£ 50 Ø±ÙˆÙ¾Û’ Easypaisa Ú©Ø±ÛŒÚº<br>
                    3ï¸âƒ£ Code Ø­Ø§ØµÙ„ Ú©Ø±ÛŒÚº<br>
                    4ï¸âƒ£ Ú¯ÛŒÙ… Ú©Ú¾ÛŒÙ„ÛŒÚº Ø§ÙˆØ± Ø¬ÛŒØªÛŒÚº!
                </p>
            </div>
            
            <button onclick="contactForPuzzle()" style="background: #16a34a; color: white; border: none; padding: 15px 30px; border-radius: 12px; font-size: 1.2rem; font-weight: bold; cursor: pointer; width: 100%; margin: 10px 0;">
                ğŸ“± ÙˆØ§Ù¹Ø³ Ø§ÛŒÙ¾ Ù¾Ø± Ø±Ø§Ø¨Ø·Û Ú©Ø±ÛŒÚº
            </button>
            
            <button onclick="showPuzzleCodeInput()" style="background: var(--accent2); color: #000; border: none; padding: 15px 30px; border-radius: 12px; font-size: 1.2rem; font-weight: bold; cursor: pointer; width: 100%; margin: 10px 0;">
                ğŸ”‘ Ù…ÛŒØ±Û’ Ù¾Ø§Ø³ Ú©ÙˆÚˆ ÛÛ’
            </button>
            
            <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 10px; margin-top: 20px;">
                <p style="font-size: 0.9rem; color: #ffd700;">ğŸ“² Easypaisa Ù†Ù…Ø¨Ø±:</p>
                <p style="font-size: 1.3rem; font-weight: bold; letter-spacing: 2px;">03359079528</p>
            </div>
        </div>

        <div id="puzzle-game" style="display:none;">
            <div class="timer-circle" id="timer">60</div>
            <div style="color: #00d2ff; font-size: 16px; margin-bottom: 15px; font-weight: bold;" id="q-number">Ø³ÙˆØ§Ù„ 1 / 5</div>
            <div class="q-text" id="q-content">Ù„ÙˆÚˆÙ†Ú¯...</div>
            <div id="options-box"></div>
        </div>

        <div id="puzzle-success" style="display:none;">
            <div style="background: linear-gradient(135deg, var(--success) 0%, #26de81 100%); color: #000; padding: 25px; border-radius: 15px; font-weight: bold; margin-bottom: 25px;">
                <h2>ğŸ‰ Ù…Ø¨Ø§Ø±Ú© ÛÙˆ!</h2>
                <p style="font-size: 18px; margin-top: 10px;">Ø¢Ù¾ Ù†Û’ ØªÙ…Ø§Ù… Ù¾Ø²Ù„ Ø­Ù„ Ú©Ø± Ù„ÛŒÛ’ ÛÛŒÚº</p>
            </div>
            <p style="font-size: 18px; font-weight: bold; margin-bottom: 10px;">Ø¢Ù¾ Ú©ÛŒ Ù¹Ø±ÛŒÚ©Ù†Ú¯ Ø¢Ø¦ÛŒ ÚˆÛŒ:</p>
            <div class="tracking-display" id="tracking-id">LOADING...</div>
            <p style="font-size: 14px; color: #aaa; line-height: 1.6; margin: 15px 0;">
                ğŸ“¸ Ø§Ø³ Ø¢Ø¦ÛŒ ÚˆÛŒ Ú©Ø§ Ø§Ø³Ú©Ø±ÛŒÙ† Ø´Ø§Ù¹ Ù„ÛŒÚº<br>
                ğŸ“² Easypaisa: <strong>03359079528</strong><br>
                ğŸ“± ÙˆØ§Ù¹Ø³ Ø§ÛŒÙ¾: <strong>03159226260</strong> ÛŒØ§ <strong>03125540048</strong>
            </p>
        </div>
    </div>

    <div id="pay-modal" class="modal">
        <div class="modal-box">
            <h2>ğŸ”’ Ù„Ø§Ú©</h2>
            <p id="pay-info" style="margin:15px 0; white-space: pre-line;"></p>
            <div class="wa-container">
                <a id="wa-link-1" href="#" class="btn-wa" target="_blank">ÙˆØ§Ù¹Ø³ Ø§ÛŒÙ¾ 1</a>
                <a id="wa-link-2" href="#" class="btn-wa" target="_blank">ÙˆØ§Ù¹Ø³ Ø§ÛŒÙ¾ 2</a>
            </div>
            <button onclick="showCodeInput()" style="background:none; border:1px solid var(--accent2); color:var(--accent2); padding:10px; width:100%; border-radius:8px; cursor:pointer;">ğŸ”‘ Ù…ÛŒØ±Û’ Ù¾Ø§Ø³ Ú©ÙˆÚˆ ÛÛ’</button>
            <p onclick="closeModals()" class="close-btn">âŒ Ø¨Ù†Ø¯ Ú©Ø±ÛŒÚº</p>
        </div>
    </div>

    <div id="code-modal" class="modal">
        <div class="modal-box">
            <h2>ğŸ”‘ Ú©ÙˆÚˆ Ø¯Ø±Ø¬ Ú©Ø±ÛŒÚº</h2>
            <input type="text" id="user-code" placeholder="XXXXXX">
            <button class="btn-verify" onclick="checkAccess()">âœ… ØªØµØ¯ÛŒÙ‚ Ú©Ø±ÛŒÚº</button>
            <p onclick="closeModals()" class="close-btn">âŒ Ú©ÛŒÙ†Ø³Ù„</p>
        </div>
    </div>

    <footer>&copy; 2026 Novelistan - Premium Urdu Portal</footer>

    <script>
// ========================================
// âš ï¸ Ù¹Ø§Ø¦Ù…Ø± ØªØ¨Ø¯ÛŒÙ„ Ú©Ø±Ù†Û’ Ú©Û’ Ù„ÛŒÛ’ ØµØ±Ù ÛŒÛ 2 Ù†Ù…Ø¨Ø± Ø¨Ø¯Ù„ÛŒÚº:
// ========================================
const GAME_START_HOUR = 20;  // Ø´Ø±ÙˆØ¹ ÙˆÙ‚Øª (20 = Ø±Ø§Øª 8 Ø¨Ø¬Û’)
const GAME_END_HOUR = 23;     // Ø®ØªÙ… ÙˆÙ‚Øª (23 = Ø±Ø§Øª 11 Ø¨Ø¬Û’)
// ========================================

// ===== CONFIGURATION =====
const FOLDERS = {
    novelMain: '1PWDGvI9Pxkzma58-BDPZYAxq4Mhw1gdu',
    poetry: '1Bje7U53wmDHhuUrAvj-NaHDAXAfMiG_h',
    about: '1QHIFfbqFIcpzHKEwEzPlRovHrC4t7wkX'
};

const NOVELS = { 
    'Ø¨Ø§Ø²Ú¯Ø´Øª Ø¹Ø´Ù‚': '1AnTGqNqtKQxRHKRXZaGxVy4H7EtlfQjI' 
};

const API_KEY = 'AIzaSyCMppjIJi2_xBi3oLVXN0XjdANMX10xmwE';
const WA_NUMBERS = ['923159226260', '923125540048'];
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwk4hNSimgU__x1PHwrjJZe_596-2Ay-y6uTHamx7zYlSZP1MGg_dQXNtw73_f2VIKh/exec";

// ===== GLOBAL VARIABLES =====
let unlocked = JSON.parse(localStorage.getItem('nov_unlocked')) || [];
let currentPkg = "", currentNovel = "", currentScreen = "home";
const cache = {};
let puzzles = [];
let currentIndex = 0;
let clock = null;
let secondsLeft = 60;
let userFullName = "";
let usedCode = "";

// ===== HELPER FUNCTIONS =====
function getDailyCode(pkgId) {
    const d = new Date();
    return (pkgId + d.getDate() + (d.getMonth() + 1) + "X").toUpperCase();
}

function getPkg(n) {
    if (n <= 10) return { id: "FREE", price: 0 };
    if (n <= 50) return { id: "P1_" + Math.ceil((n-10)/5), price: 50 };
    if (n <= 80) return { id: "P2_" + Math.ceil((n-50)/5), price: 100 };
    return { id: "P3_FINAL", price: 300 };
}

// ===== NAVIGATION =====
function openSection(mode) {
    document.getElementById('home-screen').style.display = 'none';
    
    if (mode === 'novel') {
        showNovelList();
    } else if (mode === 'puzzle') {
        showPuzzleSection();
    } else {
        currentScreen = mode;
        document.getElementById('content-screen').style.display = 'block';
        const titles = { poetry: "ğŸ“œ Ø§Ø±Ø¯Ùˆ Ø´Ø§Ø¹Ø±ÛŒ", about: "ğŸ‘¤ Ù…ØµÙ†Ù" };
        document.getElementById('section-title').innerText = titles[mode] || "";
        loadFiles(FOLDERS[mode]);
    }
}

function goBack() {
    if (currentScreen === "episodes") openSection('novel');
    else location.reload();
}

// ===== NOVEL FUNCTIONS =====
function showNovelList() {
    currentScreen = "novelList";
    document.getElementById('novel-list-screen').style.display = 'block';
    const container = document.getElementById('novels-container');
    container.innerHTML = Object.keys(NOVELS).map(name => `
        <div class="novel-list-card" onclick="openNovel('${name}')">
            <h3>ğŸ“– ${name}</h3>
            <p>ØªÙ…Ø§Ù… Ø§Ù‚Ø³Ø§Ø· Ø¯Ø³ØªÛŒØ§Ø¨ ÛÛŒÚº</p>
        </div>
    `).join('');
}

function openNovel(novelName) {
    currentScreen = "episodes";
    currentNovel = novelName;
    document.getElementById('novel-list-screen').style.display = 'none';
    document.getElementById('content-screen').style.display = 'block';
    document.getElementById('section-title').innerText = `ğŸ“š ${novelName}`;
    renderNovel(NOVELS[novelName]);
}

function renderNovel(folderId) {
    const list = document.getElementById('items-list');
    let html = '';
    
    for (let i = 1; i <= 100; i++) {
        let pkg = getPkg(i);
        const isOpen = i <= 10 || unlocked.includes(pkg.id);
        html += `
            <div class="card ${isOpen ? '' : 'locked'}" onclick="${isOpen ? `fetchAndOpen(${i}, '${folderId}')` : `showLock(${i}, '${pkg.id}', ${pkg.price})`}">
                <span>Ù‚Ø³Ø· ${i}<br><small style="color:${isOpen?'#22c55e':'#ff0a54'}">${isOpen?'ğŸ”“ Ø§ÙˆÙ¾Ù†':'ğŸ”’ Ù„Ø§Ú©'}</small></span>
            </div>`;
    }
    list.innerHTML = html;
}

function showLock(i, pkgId, price) {
    currentPkg = pkgId;
    document.getElementById('pay-info').innerText = `ğŸ“¦ Ù‚Ø³Ø· ${i} Ù¾ÛŒÚ©ÛŒØ¬ Ú©Ø§ Ø­ØµÛ ÛÛ’\nğŸ’° Ù‚ÛŒÙ…Øª: ${price} Ø±ÙˆÙ¾Û’`;
    const msg = encodeURIComponent(`Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÛŒÚ©Ù…! Ù…Ø¬Ú¾Û’ ${currentNovel} Ú©Ø§ Ù¾ÛŒÚ©ÛŒØ¬ ${pkgId} Ø®Ø±ÛŒØ¯Ù†Ø§ ÛÛ’Û”`);
    document.getElementById('wa-link-1').href = `https://wa.me/${WA_NUMBERS[0]}?text=${msg}`;
    document.getElementById('wa-link-2').href = `https://wa.me/${WA_NUMBERS[1]}?text=${msg}`;
    document.getElementById('pay-modal').classList.add('active');
}

function checkAccess() {
    if (document.getElementById('user-code').value.trim().toUpperCase() === getDailyCode(currentPkg)) {
        unlocked.push(currentPkg);
        localStorage.setItem('nov_unlocked', JSON.stringify(unlocked));
        alert("âœ… Ø§Ù† Ù„Ø§Ú© ÛÙˆ Ú¯ÛŒØ§!");
        location.reload();
    } else {
        alert("âŒ ØºÙ„Ø· Ú©ÙˆÚˆ!");
    }
}

async function fetchAndOpen(name, fId) {
    try {
        const res = await fetch(`https://www.googleapis.com/drive/v3/files?q='${fId}'+in+parents+and+name+contains+'${name}'+and+trashed=false&key=${API_KEY}&fields=files(id,webViewLink)`);
        const data = await res.json();
        if (data.files.length) window.open(data.files[0].webViewLink, '_blank');
        else alert("âŒ ÙØ§Ø¦Ù„ Ù†ÛÛŒÚº Ù…Ù„ÛŒ!");
    } catch (e) { alert("âš ï¸ Ø§ÛŒØ±Ø±!"); }
}

// ===== FILES LOADING =====
async function loadFiles(fId) {
    const list = document.getElementById('items-list');
    if (cache[fId]) return renderFiles(cache[fId]);
    list.innerHTML = '<p style="grid-column:1/-1; text-align:center;">â³ Ù„ÙˆÚˆ ÛÙˆ Ø±ÛØ§ ÛÛ’...</p>';
    try {
        const res = await fetch(`https://www.googleapis.com/drive/v3/files?q='${fId}'+in+parents+and+trashed=false&key=${API_KEY}&fields=files(id,name,webViewLink,mimeType)&pageSize=40`);
        const data = await res.json();
        cache[fId] = data.files;
        renderFiles(data.files);
    } catch (e) { list.innerHTML = '<p>âš ï¸ Ù†ÛŒÙ¹ ÙˆØ±Ú© Ø§ÛŒØ±Ø±</p>'; }
}

function renderFiles(files) {
    const list = document.getElementById('items-list');
    list.innerHTML = files.map(f => `
        <div class="card" onclick="window.open('${f.mimeType.includes('image') ? `https://drive.google.com/uc?export=view&id=${f.id}` : f.webViewLink}', '_blank')">
            <span>${f.name.split('.')[0]}</span>
        </div>
    `).join('');
}

// ===== MODALS =====
function closeModals() {
    document.querySelectorAll('.modal').forEach(m => m.classList.remove('active'));
}

function showCodeInput() {
    closeModals();
    document.getElementById('code-modal').classList.add('active');
}

// ===== PUZZLE GAME =====
function showPuzzleSection() {
    const now = new Date();
    const hour = now.getHours();
    const isGameTime = (hour >= GAME_START_HOUR && hour < GAME_END_HOUR);
    
    if (!isGameTime) {
        alert(`â° Ú¯ÛŒÙ… Ú©Ø§ ÙˆÙ‚Øª:\n${GAME_START_HOUR}:00 Ø³Û’ ${GAME_END_HOUR}:00 ØªÚ©\n\nØ§Ø¨Ú¾ÛŒ ÙˆÙ‚Øª: ${now.toLocaleTimeString('ur-PK', {hour: '2-digit', minute: '2-digit'})}`);
        return;
    }
    
    currentScreen = "puzzle";
    document.getElementById('puzzle-screen').style.display = 'block';
    document.getElementById('puzzle-info').style.display = 'block';
    document.getElementById('puzzle-game').style.display = 'none';
    document.getElementById('puzzle-success').style.display = 'none';
}

function contactForPuzzle() {
    const message = encodeURIComponent(`Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÛŒÚ©Ù…! ğŸ®\n\nÙ…ÛŒÚº Ù¾Ø²Ù„ Ú¯ÛŒÙ… Ú©Ú¾ÛŒÙ„Ù†Ø§ Ú†Ø§ÛØªØ§/Ú†Ø§ÛØªÛŒ ÛÙˆÚºÛ”\n\nğŸ’° ÙÛŒØ³: 50 Ø±ÙˆÙ¾Û’\nğŸ† Ø§Ù†Ø¹Ø§Ù…: 1000 Ø±ÙˆÙ¾Û’\nğŸ“² Easypaisa: 03359079528\n\nØ¨Ø±Ø§Û Ú©Ø±Ù… Ú©ÙˆÚˆ Ø¨Ú¾ÛŒØ¬ÛŒÚºÛ”`);
    
    const choice = confirm(`Ú©Ø³ Ù†Ù…Ø¨Ø± Ù¾Ø± Ø±Ø§Ø¨Ø·Û Ú©Ø±ÛŒÚºØŸ\n\nOK = ${WA_NUMBERS[0]}\nCancel = ${WA_NUMBERS[1]}`);
    const selectedNumber = choice ? WA_NUMBERS[0] : WA_NUMBERS[1];
    window.open(`https://wa.me/${selectedNumber}?text=${message}`, '_blank');
}

async function showPuzzleCodeInput() {
    const code = prompt("ğŸ”‘ Ø§Ù¾Ù†Ø§ Puzzle Game Ú©ÙˆÚˆ Ø¯Ø±Ø¬ Ú©Ø±ÛŒÚº:");
    
    if (!code || code.trim() === "") {
        alert("âŒ Ú©ÙˆÚˆ Ø¯Ø±Ø¬ Ú©Ø±ÛŒÚº!");
        return;
    }

    const enteredCode = code.trim().toUpperCase();

    try {
        const response = await fetch(`${SCRIPT_URL}?action=verifyCode&code=${encodeURIComponent(enteredCode)}`);